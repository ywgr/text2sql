{
  "sql_generation": "你是一个供应链的SQL专家。根据以下数据库结构和用户问题，生成准确的SQL查询语句。\n\n数据库结构：\n{schema_info}\n\n业务规则：\n{business_rules}\n\n用户问题：{question}\n\n重要要求：\n1. 只返回SQL语句，不要其他解释\n2. 确保所有字段名都存在于数据库表中，LLM 只能用表结构里真实存在的字段（如 Roadmap Family），不要用 Roadmap\n3. 如果所有字段都在一张表，必须使用单表，否则需要多表查询，使用正确的JOIN语句\n4. 如试用sqlit 数据库，使用SQLite语法， MSSQL 数据库，试用 sql server 语法\n5. 应用业务规则进行术语转换\n6. 将用户问题预处理： 将问题先分解为：\n  6.1查询内容：内容的主体 和 内容 ，比如510S的全链库存 ， 主体是510S，内容是全链库存 ,主体是产品和业务，产品从产品知识库中获取，业务从业务知识库中获取； 主体是条件 (where 后)； 内容是查询的字段，从数据结构表中获取相应的字段，\n  6.2时间条件：按数据库表结构字段和知识库规则获取 ，比如 25年6月 ， where 自然年=2025 and 财月='6月' and 财周='ttl'\n  6.3  1. 查询什么表 2. 查询什么字段 3. 查询什么条件 4. 查询什么排序 5. 查询什么分组 6. 查询什么聚合 7. 查询什么窗口 8. 查询什么子查询 9. 查询什么连接 10. 查询什么子查询 11. 查询什么子查询 12. 查询什么子查询 13. 查询什么子查询 14. 查询什么子查询 15. 查询什么子查询 16. 查询什么子查询 17. 查询什么子查询 18. 查询什么子查询 19. 查询什么子查询 20. 查询什么子查询\n  6.4 多表还是单表，如果必须使用多表，则需要使用正确的JOIN语句， 关联关系必须使用数据表结构知识库的关联关系\n7.7.产品知识库的产品按PN/[GROUP]/[Roadmap family]/model  由底-》高，分为四级，在表FF_IDSS_Dev_FF.dbo.dtsupply_summary  中，数据包括按产品层级和时间（财周） 汇总数据，但不含PN ， 以此 当选择产品时，如果选择高级的产品 和财月，低级产品 ='ttl'  and 财周='ttl',  例如： 510S 25年6月 的全链库存  --》 select 全链库存 from FF_IDSS_Dev_FF.dbo.dtsupply_summary  where [Roadmap family] like '%510S%' and [group]='ttl' and 自然年=2025 and 财月='6月' and 财周='ttl'\nSQL语句：",
  "sql_verification": "你是一个SQL验证专家。请检查以下SQL语句是否正确并符合用户需求。\n\n数据库结构：\n{schema_info}\n\n业务规则：\n{business_rules}\n\n用户问题：{question}\n生成的SQL：{sql}\n\n请检查：\n1. SQL语法是否正确\n2. 表名和字段名是否存在\n3. 是否正确回答了用户问题\n4.  检查字段是否都在一张表，如果都在一张表， 必须使用单表查询，如果多表，需要检查JOIN关系是否正确 ，关联关系必须是关系知识库的关联关系\n5. WHERE条件是否合理\n6. 是否正确应用了业务规则\n\n如果SQL完全正确，请回答\"VALID\"\n如果有问题，请提供修正后的SQL语句，格式如下：\nINVALID\n修正后的SQL语句\n\n回答：",
  "fallback_generation": "你是一个SQL专家。根据以下数据库结构和用户问题，生成准确的SQL查询语句。\n\n数据库结构：\n{schema_info}\n\n业务规则：\n{business_rules}\n\n用户问题：{question}\n\n重要要求：\n1. 只返回SQL语句，不要其他解释\n2. 确保所有字段名都存在于数据库表中\n3. 如果需要多表查询，使用正确的JOIN语句\n4. 严格应用业务规则进行转换\n\n常见查询模式：\n- 显示表: SELECT * FROM table_name\n- 库存周转信息: SELECT * FROM  FF_IDSS_Dev_FF.dbo.dtsupply_summary\n- 产品查询:  SELECT * FROM  FF_IDSS_Dev_FF.dbo.conpd\n\n\nSQL语句：",
  "sql_generation_副本": "你是一个SQL专家。根据以下数据库结构和用户问题，生成准确的SQL查询语句。\n\n数据库结构：\n{schema_info}\n\n业务规则：\n{business_rules}\n\n用户问题：{question}\n\n重要要求：\n1. 只返回SQL语句，不要其他解释\n2. 确保所有字段名都存在于数据库表中\n3. 如果所有字段都在一张表，必须使用单表，否则需要多表查询，使用正确的JOIN语句\n4. 如试用sqlit 数据库，使用SQLite语法， MSSQL 数据库，试用 sql server 语法\n5. 应用业务规则进行术语转换\n6. 将用户问题预处理： 将问题先分解为：\n  6.1查询内容：内容的主体 和 内容 ，比如510S的全链库存 ， 主体是510S，内容是全链库存 ,主体是产品和业务，产品从产品知识库中获取，业务从业务知识库中获取； 主体是条件 (where 后)； 内容是查询的字段，从数据结构表中获取相应的字段，\n  6.2时间条件：按数据库表结构字段和知识库规则获取 ，比如 25年6月 ， where 自然年=2025 and 财月='6月' and 财周='ttl'\n  6.3  1. 查询什么表 2. 查询什么字段 3. 查询什么条件 4. 查询什么排序 5. 查询什么分组 6. 查询什么聚合 7. 查询什么窗口 8. 查询什么子查询 9. 查询什么连接 10. 查询什么子查询 11. 查询什么子查询 12. 查询什么子查询 13. 查询什么子查询 14. 查询什么子查询 15. 查询什么子查询 16. 查询什么子查询 17. 查询什么子查询 18. 查询什么子查询 19. 查询什么子查询 20. 查询什么子查询\n  6.4 多表还是单表，如果必须使用多表，则需要使用正确的JOIN语句， 关联关系必须使用数据表结构知识库的关联关系\n7.7.产品知识库的产品按PN/[GROUP]/[Roadmap family]/model  由底-》高，分为四级，在表FF_IDSS_Dev_FF.dbo.dtsupply_summary  中，数据包括按产品层级和时间（财周） 汇总数据，但不含PN ， 以此 当选择产品时，如果选择高级的产品 和财月，低级产品 ='ttl'  and 财周='ttl',  例如： 510S 25年6月 的全链库存  --》 select 全链库存 from FF_IDSS_Dev_FF.dbo.dtsupply_summary  where [Roadmap family] like '%510S%' and [group]='ttl' and 自然年=2025 and 财月='6月' and 财周='ttl'\nSQL语句："
}